15/03/2019 01:22:47 Using debug logging
15/03/2019 01:22:47 Input parameters max_nesting: 10, min_match_length: 3
15/03/2019 01:22:47 Read from MSA file sample_example/nested.fa
15/03/2019 01:22:48 consensus: AAAAAAAAAAAAAAA***********************CGTGCGTGCGTGCGTGCGTGCGTG
15/03/2019 01:22:48 have match string AAAAAAAAAAAAAAA
15/03/2019 01:22:48 add match interval to complete step [0,14]
15/03/2019 01:22:48 at end have match string CGTGCGTGCGTGCGTGCGTGCGTG
15/03/2019 01:22:48 add non-match interval at end as have alts [15,37]
15/03/2019 01:22:48 add match interval at end [38,61]
15/03/2019 01:22:48 Non match intervals: [[15, 37]]
15/03/2019 01:22:48 Divide sequences into subgroups and define prg for each subgroup.
15/03/2019 01:22:48 Get kmeans partition of interval [15, 37]
15/03/2019 01:22:48 Add classes corresponding to 1 small sequences
15/03/2019 01:22:48 Now add classes corresponding to 3 longer sequences
15/03/2019 01:22:48 First transform sequences into kmer occurance vectors
15/03/2019 01:22:48 self.kmer_dict = {'TTT': 0, 'TTA': 1, 'TAT': 2, 'ATT': 3, 'TTC': 4, 'TCT': 5, 'CTT': 6, 'TTG': 7, 'TGT': 8, 'GTT': 9}
15/03/2019 01:22:48 These vectors have length 10
15/03/2019 01:22:48 seq_kmer_counts = [[6. 2. 2. 2. 2. 2. 2. 1. 1. 1.]
 [6. 1. 1. 1. 3. 3. 3. 1. 1. 1.]
 [6. 2. 2. 2. 0. 0. 0. 3. 3. 3.]]
15/03/2019 01:22:48 Now cluster:
15/03/2019 01:22:48 number of clusters: 1, inertia: 24.000000
15/03/2019 01:22:48 number of clusters: 2, inertia: 3.000000
15/03/2019 01:22:48 Extract equivalence classes from this partition
15/03/2019 01:22:48 Merge return id lists for the partitions
15/03/2019 01:22:48 add (small) return ids: ['1']
15/03/2019 01:22:48 want to add (big) return ids: ['2']
15/03/2019 01:22:48 add (big) return ids 0: ['2', '3']
15/03/2019 01:22:48 want to add (big) return ids: ['4']
15/03/2019 01:22:48 add (big) return ids 1: ['4']
15/03/2019 01:22:48 Clustering:
15/03/2019 01:22:48 Input alignments: SingleLetterAlphabet() alignment with 4 rows and 23 columns
----------------------- 1
TTTATTTCTTTGTTTATTTCTTT 2
TTTCTTTATTTCTTTCTTTGTTT 3
TTTGTTTGTTTATTTGTTTATTT 4
15/03/2019 01:22:48 Output clusters: [['1'], ['2', '3'], ['4']]
15/03/2019 01:22:48 subAlignedSeqs now has keys: [15]
15/03/2019 01:22:48 consensus: -----------------------
15/03/2019 01:22:48 add short match whole interval [0,22]
15/03/2019 01:22:48 Non match intervals: []
15/03/2019 01:22:48 consensus: TTT*TTT*TTT*TTT*TTT*TTT
15/03/2019 01:22:48 have match string TTT
15/03/2019 01:22:48 add match interval to complete step [0,2]
15/03/2019 01:22:48 have match string TTT
15/03/2019 01:22:48 add non-match interval as have alts [3,3]
15/03/2019 01:22:48 add match interval to complete step [4,6]
15/03/2019 01:22:48 have match string TTT
15/03/2019 01:22:48 add non-match interval as have alts [7,7]
15/03/2019 01:22:48 add match interval to complete step [8,10]
15/03/2019 01:22:48 have match string TTT
15/03/2019 01:22:48 add non-match interval as have alts [11,11]
15/03/2019 01:22:48 add match interval to complete step [12,14]
15/03/2019 01:22:48 have match string TTT
15/03/2019 01:22:48 add non-match interval as have alts [15,15]
15/03/2019 01:22:48 add match interval to complete step [16,18]
15/03/2019 01:22:48 at end have match string TTT
15/03/2019 01:22:48 add non-match interval at end as have alts [19,19]
15/03/2019 01:22:48 add match interval at end [20,22]
15/03/2019 01:22:48 Non match intervals: [[3, 3], [7, 7], [11, 11], [15, 15], [19, 19]]
15/03/2019 01:22:48 Have reached max nesting level or have a small variant site, so add all variant sequences in interval.
15/03/2019 01:22:48 Variant seqs found: ['A', 'C']
15/03/2019 01:22:48 Which is equivalent to: ['A', 'C']
15/03/2019 01:22:48 Have reached max nesting level or have a small variant site, so add all variant sequences in interval.
15/03/2019 01:22:48 Variant seqs found: ['C', 'A']
15/03/2019 01:22:48 Which is equivalent to: ['A', 'C']
15/03/2019 01:22:48 Have reached max nesting level or have a small variant site, so add all variant sequences in interval.
15/03/2019 01:22:48 Variant seqs found: ['G', 'C']
15/03/2019 01:22:48 Which is equivalent to: ['G', 'C']
15/03/2019 01:22:48 Have reached max nesting level or have a small variant site, so add all variant sequences in interval.
15/03/2019 01:22:48 Variant seqs found: ['A', 'C']
15/03/2019 01:22:48 Which is equivalent to: ['A', 'C']
15/03/2019 01:22:48 Have reached max nesting level or have a small variant site, so add all variant sequences in interval.
15/03/2019 01:22:48 Variant seqs found: ['C', 'G']
15/03/2019 01:22:48 Which is equivalent to: ['G', 'C']
15/03/2019 01:22:48 consensus: TTTGTTTGTTTATTTGTTTATTT
15/03/2019 01:22:48 at end have match string TTTGTTTGTTTATTTGTTTATTT
15/03/2019 01:22:48 add match interval at end as only one seq [0,22]
15/03/2019 01:22:48 Non match intervals: []
15/03/2019 01:22:48 Write PRG file to sample_example/nested.fa.max_nest10.min_match3.prg
15/03/2019 01:22:48 self.subAlignedSeqs.keys(): [15]
15/03/2019 01:22:48 self.subAlignedSeqs[self.subAlignedSeqs.keys()[0]]: [<__main__.AlignedSeq object at 0x1118259b0>, <__main__.AlignedSeq object at 0x111825898>, <__main__.AlignedSeq object at 0x111825a90>]
15/03/2019 01:22:48 interval start: 15
15/03/2019 01:22:48 type of subAlignedSeqs object in list: <class '__main__.AlignedSeq'>
15/03/2019 01:22:48 self.subAlignedSeqs == {} at nesting level 2 for interval [15, 37]
15/03/2019 01:22:48 found the max of [2] is 2
15/03/2019 01:22:48 recur max level nesting returned: 2, which has type <class 'int'>
15/03/2019 01:22:48 type of subAlignedSeqs object in list: <class '__main__.AlignedSeq'>
15/03/2019 01:22:48 self.subAlignedSeqs == {} at nesting level 2 for interval [15, 37]
15/03/2019 01:22:48 found the max of [2] is 2
15/03/2019 01:22:48 recur max level nesting returned: 2, which has type <class 'int'>
15/03/2019 01:22:48 type of subAlignedSeqs object in list: <class '__main__.AlignedSeq'>
15/03/2019 01:22:48 self.subAlignedSeqs == {} at nesting level 2 for interval [15, 37]
15/03/2019 01:22:48 found the max of [2] is 2
15/03/2019 01:22:48 recur max level nesting returned: 2, which has type <class 'int'>
15/03/2019 01:22:48 found the max of [2, 2, 2] is 2
15/03/2019 01:22:48 Max_nesting_reached	2
15/03/2019 01:22:48 Write GFA file to sample_example/nested.fa.max_nest10.min_match3.gfa
15/03/2019 01:22:48 gfa_site: 5
15/03/2019 01:22:48 prgs: ['AAAAAAAAAAAAAAA', ' 6 TTT 7 A 8 C 7 TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT 6 TTTGTTTGTTTATTTGTTTATTT', 'CGTGCGTGCGTGCGTGCGTGCGTG']
15/03/2019 01:22:48 vars: ['', 'TTT 7 A 8 C 7 TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT', 'TTTGTTTGTTTATTTGTTTATTT']
15/03/2019 01:22:48 gfa_site: 7
15/03/2019 01:22:48 gfa_site: 7
15/03/2019 01:22:48 prgs: ['TTT', 'A 8 C', 'TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:22:48 vars: ['A', 'C']
15/03/2019 01:22:48 gfa_site: 9
15/03/2019 01:22:48 gfa_site: 9
15/03/2019 01:22:48 prgs: ['TTT', 'A 10 C', 'TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:22:48 vars: ['A', 'C']
15/03/2019 01:22:48 gfa_site: 11
15/03/2019 01:22:48 gfa_site: 11
15/03/2019 01:22:48 prgs: ['TTT', 'G 12 C', 'TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:22:48 vars: ['G', 'C']
15/03/2019 01:22:48 gfa_site: 13
15/03/2019 01:22:48 gfa_site: 13
15/03/2019 01:22:48 prgs: ['TTT', 'A 14 C', 'TTT 15 G 16 C 15 TTT']
15/03/2019 01:22:48 vars: ['A', 'C']
15/03/2019 01:22:48 gfa_site: 15
15/03/2019 01:22:48 gfa_site: 15
15/03/2019 01:22:48 prgs: ['TTT', 'G 16 C', 'TTT']
15/03/2019 01:22:48 vars: ['G', 'C']
15/03/2019 01:22:48 gfa_site: 17
15/03/2019 01:22:48 self.subAlignedSeqs.keys(): [15]
15/03/2019 01:22:48 self.subAlignedSeqs[self.subAlignedSeqs.keys()[0]]: [<__main__.AlignedSeq object at 0x1118259b0>, <__main__.AlignedSeq object at 0x111825898>, <__main__.AlignedSeq object at 0x111825a90>]
15/03/2019 01:22:48 interval start: 15
15/03/2019 01:22:48 type of subAlignedSeqs object in list: <class '__main__.AlignedSeq'>
15/03/2019 01:22:48 self.subAlignedSeqs == {} at nesting level 2 for interval [15, 37]
15/03/2019 01:22:48 found the max of [2] is 2
15/03/2019 01:22:48 recur max level nesting returned: 2, which has type <class 'int'>
15/03/2019 01:22:48 type of subAlignedSeqs object in list: <class '__main__.AlignedSeq'>
15/03/2019 01:22:48 self.subAlignedSeqs == {} at nesting level 2 for interval [15, 37]
15/03/2019 01:22:48 found the max of [2] is 2
15/03/2019 01:22:48 recur max level nesting returned: 2, which has type <class 'int'>
15/03/2019 01:22:48 type of subAlignedSeqs object in list: <class '__main__.AlignedSeq'>
15/03/2019 01:22:48 self.subAlignedSeqs == {} at nesting level 2 for interval [15, 37]
15/03/2019 01:22:48 found the max of [2] is 2
15/03/2019 01:22:48 recur max level nesting returned: 2, which has type <class 'int'>
15/03/2019 01:22:48 found the max of [2, 2, 2] is 2
15/03/2019 01:26:29 Using debug logging
15/03/2019 01:26:29 Input parameters max_nesting: 10, min_match_length: 3
15/03/2019 01:26:29 Read from MSA file sample_example/nested.fa
15/03/2019 01:26:29 consensus: AAAAAAAAAAAAAAA***********************CGTGCGTGCGTGCGTGCGTGCGTG
15/03/2019 01:26:29 have match string AAAAAAAAAAAAAAA
15/03/2019 01:26:29 add match interval to complete step [0,14]
15/03/2019 01:26:29 at end have match string CGTGCGTGCGTGCGTGCGTGCGTG
15/03/2019 01:26:29 add non-match interval at end as have alts [15,37]
15/03/2019 01:26:29 add match interval at end [38,61]
15/03/2019 01:26:29 Non match intervals: [[15, 37]]
15/03/2019 01:26:29 Reading from a PRG file which already exists. To regenerate, delete it.
15/03/2019 01:26:29 Write GFA file to sample_example/nested.fa.max_nest10.min_match3.gfa
15/03/2019 01:26:29 gfa_site: 5
15/03/2019 01:26:29 prgs: ['AAAAAAAAAAAAAAA', ' 6 TTT 7 A 8 C 7 TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT 6 TTTGTTTGTTTATTTGTTTATTT', 'CGTGCGTGCGTGCGTGCGTGCGTG']
15/03/2019 01:26:29 vars: ['', 'TTT 7 A 8 C 7 TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT', 'TTTGTTTGTTTATTTGTTTATTT']
15/03/2019 01:26:29 gfa_site: 7
15/03/2019 01:26:29 gfa_site: 7
15/03/2019 01:26:29 prgs: ['TTT', 'A 8 C', 'TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:26:29 vars: ['A', 'C']
15/03/2019 01:26:29 gfa_site: 9
15/03/2019 01:26:29 gfa_site: 9
15/03/2019 01:26:29 prgs: ['TTT', 'A 10 C', 'TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:26:29 vars: ['A', 'C']
15/03/2019 01:26:29 gfa_site: 11
15/03/2019 01:26:29 gfa_site: 11
15/03/2019 01:26:29 prgs: ['TTT', 'G 12 C', 'TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:26:29 vars: ['G', 'C']
15/03/2019 01:26:29 gfa_site: 13
15/03/2019 01:26:29 gfa_site: 13
15/03/2019 01:26:29 prgs: ['TTT', 'A 14 C', 'TTT 15 G 16 C 15 TTT']
15/03/2019 01:26:29 vars: ['A', 'C']
15/03/2019 01:26:29 gfa_site: 15
15/03/2019 01:26:29 gfa_site: 15
15/03/2019 01:26:29 prgs: ['TTT', 'G 16 C', 'TTT']
15/03/2019 01:26:29 vars: ['G', 'C']
15/03/2019 01:26:29 gfa_site: 17
15/03/2019 01:26:29 self.subAlignedSeqs == {} at nesting level 1 for interval None
15/03/2019 01:26:29 found the max of [1] is 1
15/03/2019 01:29:14 Using debug logging
15/03/2019 01:29:14 Input parameters max_nesting: 10, min_match_length: 3
15/03/2019 01:29:14 Read from MSA file sample_example/nested.fa
15/03/2019 01:29:14 consensus: AAAAAAAAAAAAAAA***********************CGTGCGTGCGTGCGTGCGTGCGTG
15/03/2019 01:29:14 have match string AAAAAAAAAAAAAAA
15/03/2019 01:29:14 add match interval to complete step [0,14]
15/03/2019 01:29:14 at end have match string CGTGCGTGCGTGCGTGCGTGCGTG
15/03/2019 01:29:14 add non-match interval at end as have alts [15,37]
15/03/2019 01:29:14 add match interval at end [38,61]
15/03/2019 01:29:14 Non match intervals: [[15, 37]]
15/03/2019 01:29:14 Reading from a PRG file which already exists. To regenerate, delete it.
15/03/2019 01:29:14 Write GFA file to sample_example/nested.fa.max_nest10.min_match3.gfa
15/03/2019 01:29:14 gfa_site: 5
15/03/2019 01:29:14 prgs: ['AAAAAAAAAAAAAAA', ' 6 TTT 7 A 8 C 7 TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT 6 TTTGTTTGTTTATTTGTTTATTT', 'CGTGCGTGCGTGCGTGCGTGCGTG']
15/03/2019 01:29:14 vars: ['', 'TTT 7 A 8 C 7 TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT', 'TTTGTTTGTTTATTTGTTTATTT']
15/03/2019 01:29:14 gfa_site: 7
15/03/2019 01:29:14 gfa_site: 7
15/03/2019 01:29:14 prgs: ['TTT', 'A 8 C', 'TTT 9 A 10 C 9 TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:29:14 vars: ['A', 'C']
15/03/2019 01:29:14 gfa_site: 9
15/03/2019 01:29:14 gfa_site: 9
15/03/2019 01:29:14 prgs: ['TTT', 'A 10 C', 'TTT 11 G 12 C 11 TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:29:14 vars: ['A', 'C']
15/03/2019 01:29:14 gfa_site: 11
15/03/2019 01:29:14 gfa_site: 11
15/03/2019 01:29:14 prgs: ['TTT', 'G 12 C', 'TTT 13 A 14 C 13 TTT 15 G 16 C 15 TTT']
15/03/2019 01:29:14 vars: ['G', 'C']
15/03/2019 01:29:14 gfa_site: 13
15/03/2019 01:29:14 gfa_site: 13
15/03/2019 01:29:14 prgs: ['TTT', 'A 14 C', 'TTT 15 G 16 C 15 TTT']
15/03/2019 01:29:14 vars: ['A', 'C']
15/03/2019 01:29:14 gfa_site: 15
15/03/2019 01:29:14 gfa_site: 15
15/03/2019 01:29:14 prgs: ['TTT', 'G 16 C', 'TTT']
15/03/2019 01:29:14 vars: ['G', 'C']
15/03/2019 01:29:14 gfa_site: 17
15/03/2019 01:29:14 self.subAlignedSeqs == {} at nesting level 1 for interval None
15/03/2019 01:29:14 found the max of [1] is 1
